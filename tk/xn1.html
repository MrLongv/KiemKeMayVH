<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>THEO DÃ•I NÄ‚NG SUáº¤T GIá»œ XN1</title>

<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:#f3f4f6;
}
h2{
  text-align:center;
  margin:12px 0;
}
table{
  width:100%;
  border-collapse:collapse;
  background:#fff;
}
th,td{
  border:1px solid #9ca3af;
  padding:4px;
  font-size:13px;
  text-align:center;
  white-space:nowrap;
}
th{
  background:#e5e7eb;
}
input{
  width:100%;
  border:none;
  outline:none;
  background:transparent;
  text-align:center;
}
tfoot td{
  background:#d1d5db;
  font-weight:bold;
}
.total-strong{
  background:#9ca3af !important;
  font-size:14px;
}
</style>
</head>

<body>

<h2>ğŸ“Š THEO DÃ•I NÄ‚NG SUáº¤T GIá»œ â€“ XN1</h2>

<table id="tbl">

<thead>
<tr>
  <th rowspan="2">Tá»”</th>
  <th rowspan="2">MÃƒ HÃ€NG</th>
  <th rowspan="2">SL</th>
  <th rowspan="2">ÄM<br>NGÃ€Y</th>
  <th rowspan="2">ÄM<br>GIá»œ</th>
  <th rowspan="2">USD / QT</th>
  <th colspan="9">NÄ‚NG SUáº¤T THEO GIá»œ</th>
  <th rowspan="2">Cá»˜NG SP</th>
  <th rowspan="2">USD / TH</th>
  <th rowspan="2">HIá»†U SUáº¤T</th>
  <th colspan="2">LAO Äá»˜NG</th>
  <th rowspan="2">ÄÄG</th>
  <th rowspan="2">TG / QT</th>
  <th rowspan="2">USD / NGÃ€Y 100%</th>
  <th rowspan="2">CHUYá»‚N Äá»”I</th>
</tr>
<tr>
  <th>7-8</th>
  <th>8-9</th>
  <th>9-10</th>
  <th>10-11</th>
  <th>12-13</th>
  <th>13-14</th>
  <th>14-15</th>
  <th>15-16</th>
  <th>16-17</th>
  <th>TT</th>
  <th>SÄC</th>
</tr>
</thead>

<tbody>

<!-- ===== Tá»” 1 ===== -->
<tr>
<td>1</td>
<td><input></td>
<td><input></td>
<td><input class="dm-ngay"></td>
<td>
  <input class="dm-gio" readonly style="background:#f3f4f6">
</td>

<td><input class="usd-qt"></td>

<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>

<td class="tong-sp">0</td>
<td class="usd-th">0</td>
<td class="hs">0%</td>
<td><input></td>
<td><input></td>
<td><input></td>
<td><input></td>
<td class="usd100">0</td>
<td></td>
</tr>

<!-- ===== Tá»” 3 ===== -->
<tr>
<td>3</td>
<td><input></td>
<td><input></td>
<td><input class="dm-ngay"></td>
<td>
  <input class="dm-gio" readonly style="background:#f3f4f6">
</td>

<td><input class="usd-qt"></td>

<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>

<td class="tong-sp">0</td>
<td class="usd-th">0</td>
<td class="hs">0%</td>
<td><input></td>
<td><input></td>
<td><input></td>
<td><input></td>
<td class="usd100">0</td>
<td></td>
</tr>

<!-- ===== Tá»” 5 ===== -->
<tr>
<td>5</td>
<td><input></td>
<td><input></td>
<td><input class="dm-ngay"></td>
<td>
  <input class="dm-gio" readonly style="background:#f3f4f6">
</td>

<td><input class="usd-qt"></td>

<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>

<td class="tong-sp">0</td>
<td class="usd-th">0</td>
<td class="hs">0%</td>
<td><input></td>
<td><input></td>
<td><input></td>
<td><input></td>
<td class="usd100">0</td>
<td></td>
</tr>

<!-- ===== Tá»” 7 ===== -->
<tr>
<td>7</td>
<td><input></td>
<td><input></td>
<td><input class="dm-ngay"></td>
<td>
  <input class="dm-gio" readonly style="background:#f3f4f6">
</td>

<td><input class="usd-qt"></td>

<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>

<td class="tong-sp">0</td>
<td class="usd-th">0</td>
<td class="hs">0%</td>
<td><input></td>
<td><input></td>
<td><input></td>
<td><input></td>
<td class="usd100">0</td>
<td></td>
</tr>

<!-- ===== Tá»” 9 ===== -->
<tr>
<td>9</td>
<td><input></td>
<td><input></td>
<td><input class="dm-ngay"></td>
<td>
  <input class="dm-gio" readonly style="background:#f3f4f6">
</td>

<td><input class="usd-qt"></td>

<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>
<td><input class="gio"></td>

<td class="tong-sp">0</td>
<td class="usd-th">0</td>
<td class="hs">0%</td>
<td><input></td>
<td><input></td>
<td><input></td>
<td><input></td>
<td class="usd100">0</td>
<td></td>
</tr>

</tbody>

<tfoot>
<tr>
<td colspan="6">Tá»”NG USD / QT THEO GIá»œ</td>
<td class="tong-usd-gio">0</td>
<td class="tong-usd-gio">0</td>
<td class="tong-usd-gio">0</td>
<td class="tong-usd-gio">0</td>
<td class="tong-usd-gio">0</td>
<td class="tong-usd-gio">0</td>
<td class="tong-usd-gio">0</td>
<td class="tong-usd-gio">0</td>
<td class="tong-usd-gio">0</td>
<td colspan="9"></td>
</tr>

<tr>
<td colspan="6">Æ¯á»šC TÃNH USD TRONG NGÃ€Y</td>
<td class="uoc-usd-gio">0</td>
<td class="uoc-usd-gio">0</td>
<td class="uoc-usd-gio">0</td>
<td class="uoc-usd-gio">0</td>
<td class="uoc-usd-gio">0</td>
<td class="uoc-usd-gio">0</td>
<td class="uoc-usd-gio">0</td>
<td class="uoc-usd-gio">0</td>
<td class="uoc-usd-gio">0</td>
<td colspan="9"></td>
</tr>

<tr class="total-strong">
<td colspan="23">Tá»”NG USD CUá»I NGÃ€Y</td>
<td id="tong-usd-ngay">0</td>
</tr>
</tfoot>

</table>

<script>
function calc(){
  let tongNgay = 0;
  const tongUsdGio = Array(9).fill(0);

  document.querySelectorAll("tbody tr").forEach(r=>{
    const gio = [...r.querySelectorAll(".gio")].map(i=>+i.value||0);
    const usdqt = +r.querySelector(".usd-qt").value||0;
    const dmngay = +r.querySelector(".dm-ngay").value||0;
const dmGio = dmngay ? (dmngay / 9) : 0;

// gÃ¡n láº¡i vÃ o Ã´ ÄM GIá»œ
r.querySelector(".dm-gio").value = dmGio.toFixed(2);


    const tongSP = gio.reduce((a,b)=>a+b,0);
    const usdth = tongSP * usdqt;
    const hs = dmngay ? (tongSP/dmngay*100) : 0;

    r.querySelector(".tong-sp").innerText = tongSP;
    r.querySelector(".usd-th").innerText = usdth.toFixed(2);
    r.querySelector(".hs").innerText = hs.toFixed(1)+"%";
    r.querySelector(".usd100").innerText = (dmngay*usdqt).toFixed(2);

    gio.forEach((v,i)=>{
      tongUsdGio[i] += v * usdqt;
    });

    tongNgay += usdth;
  });

  document.querySelectorAll(".tong-usd-gio").forEach((c,i)=>{
    c.innerText = tongUsdGio[i].toFixed(2);
  });

  document.getElementById("tong-usd-ngay").innerText = tongNgay.toFixed(2);
}
document.addEventListener("input",calc);
</script>

</body>
</html>

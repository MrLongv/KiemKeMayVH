<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>THEO DÃ•I NÄ‚NG SUáº¤T GIá»œ XN1</title>

<style>
body{
  margin:0;
  font-family:Arial,Helvetica,sans-serif;
  background:#f3f4f6;
}
h2{
  text-align:center;
  margin:12px 0;
}
table{
  width:100%;
  border-collapse:collapse;
  background:#fff;
}
th,td{
  border:1px solid #9ca3af;
  padding:4px;
  font-size:13px;
  text-align:center;
  white-space:nowrap;
}
th{ background:#e5e7eb; }
input{
  width:100%;
  border:none;
  outline:none;
  background:transparent;
  text-align:center;
}
tfoot td{
  background:#d1d5db;
  font-weight:bold;
}
.total-strong{
  background:#9ca3af !important;
  font-size:14px;
}
.readonly{
  background:#f3f4f6;
}
</style>
</head>

<body>

<h2>ğŸ“Š THEO DÃ•I NÄ‚NG SUáº¤T GIá»œ â€“ XN1</h2>

<table id="tbl">
<thead>
<tr>
  <th rowspan="2">Tá»”</th>
  <th rowspan="2">MÃƒ HÃ€NG</th>
  <th rowspan="2">SL</th>
  <th rowspan="2">ÄM NGÃ€Y</th>
  <th rowspan="2">ÄM GIá»œ</th>
  <th rowspan="2">ÄÆ N GIÃ</th>
  <th colspan="9">Sáº¢N LÆ¯á»¢NG THEO GIá»œ</th>
  <th rowspan="2">Tá»”NG SP</th>
  <th rowspan="2">USD TH</th>
  <th rowspan="2">HIá»†U SUáº¤T</th>
  <th colspan="2">LAO Äá»˜NG</th>
  <th rowspan="2">ÄG</th>
  <th rowspan="2">TG/QT</th>
  <th rowspan="2">USD 100%</th>
  <th rowspan="2">GHI CHÃš</th>
</tr>
<tr>
  <th>7-8</th><th>8-9</th><th>9-10</th><th>10-11</th>
  <th>12-13</th><th>13-14</th><th>14-15</th><th>15-16</th><th>16-17</th>
  <th>TT</th><th>SÄC</th>
</tr>
</thead>

<tbody>
<script>
const toList = [1,3,5,7,9];
document.write(
  toList.map(t=>`
<tr>
<td>${t}</td>
<td><input></td>
<td><input></td>
<td><input class="dm-ngay"></td>
<td><input class="dm-gio readonly" readonly></td>
<td><input class="don-gia"></td>

${'<td><input class="gio"></td>'.repeat(9)}

<td class="tong-sp">0</td>
<td class="usd-th">0</td>
<td class="hs">0%</td>
<td><input></td>
<td><input></td>
<td><input></td>
<td><input></td>
<td class="usd100">0</td>
<td></td>
</tr>
`).join('')
);
</script>
</tbody>

<tfoot>
<tr>
<td colspan="6">Tá»”NG USD / GIá»œ</td>
<td class="tong-usd-gio"></td>
<td class="tong-usd-gio"></td>
<td class="tong-usd-gio"></td>
<td class="tong-usd-gio"></td>
<td class="tong-usd-gio"></td>
<td class="tong-usd-gio"></td>
<td class="tong-usd-gio"></td>
<td class="tong-usd-gio"></td>
<td class="tong-usd-gio"></td>
<td colspan="9"></td>
</tr>

<tr>
<td colspan="6">Æ¯á»šC TÃNH USD NGÃ€Y</td>
<td class="uoc-usd"></td>
<td class="uoc-usd"></td>
<td class="uoc-usd"></td>
<td class="uoc-usd"></td>
<td class="uoc-usd"></td>
<td class="uoc-usd"></td>
<td class="uoc-usd"></td>
<td class="uoc-usd"></td>
<td class="uoc-usd"></td>
<td colspan="9"></td>
</tr>

<tr class="total-strong">
<td colspan="23">Tá»”NG USD CUá»I NGÃ€Y</td>
<td id="tong-usd-ngay">0</td>
</tr>
</tfoot>
</table>

<script>
const GIO_LAM = 9;

function calc(){
  let tongUsdNgay = 0;
  const tongUsdGio = Array(GIO_LAM).fill(0);

  document.querySelectorAll("tbody tr").forEach(row=>{
    const gio = [...row.querySelectorAll(".gio")].map(i=>+i.value||0);
    const dmNgay = +row.querySelector(".dm-ngay").value||0;
    const donGia = +row.querySelector(".don-gia").value||0;

    const dmGio = dmNgay ? dmNgay/GIO_LAM : 0;
    row.querySelector(".dm-gio").value = dmGio.toFixed(2);

    const tongSP = gio.reduce((a,b)=>a+b,0);
    row.querySelector(".tong-sp").innerText = tongSP;

    const usdTh = tongSP * donGia;
    row.querySelector(".usd-th").innerText = usdTh.toFixed(2);

    const hieuSuat = dmNgay ? tongSP/dmNgay*100 : 0;
    row.querySelector(".hs").innerText = hieuSuat.toFixed(1)+"%";

    const usd100 = dmNgay * donGia;
    row.querySelector(".usd100").innerText = usd100.toFixed(2);

    gio.forEach((v,i)=>{
      tongUsdGio[i] += v * donGia;
    });

    tongUsdNgay += usdTh;
  });

  document.querySelectorAll(".tong-usd-gio").forEach((c,i)=>{
    c.innerText = tongUsdGio[i].toFixed(2);
  });

  document.querySelectorAll(".uoc-usd").forEach((c,i)=>{
    c.innerText = tongUsdGio[i].toFixed(2);
  });

  document.getElementById("tong-usd-ngay").innerText = tongUsdNgay.toFixed(2);
}

document.addEventListener("input", calc);
</script>

</body>
</html>

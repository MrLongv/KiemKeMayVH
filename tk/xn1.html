<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>THEO DÕI NĂNG SUẤT GIỜ XN1</title>

<style>
body{font-family:Arial;margin:0;background:#f3f4f6}
h2{text-align:center;margin:10px}
table{border-collapse:collapse;width:100%;background:#fff}
th,td{
  border:1px solid #9ca3af;
  padding:4px;
  font-size:13px;
  text-align:center;
  white-space:nowrap;
}
th{background:#e5e7eb}
input{
  width:100%;
  border:none;
  outline:none;
  background:transparent;
  text-align:center;
}
tfoot td{background:#d1d5db;font-weight:bold}
.total-strong{background:#9ca3af;font-size:14px}
</style>
</head>

<body>

<h2>THEO DÕI NĂNG SUẤT GIỜ XN1</h2>

<table id="tbl">
<thead>
<tr>
  <th rowspan="2">TỔ</th>
  <th rowspan="2">MÃ HÀNG</th>
  <th rowspan="2">SL</th>
  <th rowspan="2">ĐM<br>NGÀY</th>
  <th rowspan="2">ĐM<br>GIỜ</th>
  <th rowspan="2">USD/QT</th>
  <th colspan="9">NĂNG SUẤT THEO GIỜ</th>
  <th rowspan="2">CỘNG SP</th>
  <th rowspan="2">USD/TH</th>
  <th rowspan="2">HIỆU SUẤT</th>
  <th colspan="2">LAO ĐỘNG</th>
  <th rowspan="2">ĐG</th>
  <th rowspan="2">TG/QT</th>
  <th rowspan="2">USD/NGÀY 100%</th>
  <th rowspan="2">CHUYỂN ĐỔI</th>
</tr>
<tr>
  <th>7-8</th><th>8-9</th><th>9-10</th><th>10-11</th>
  <th>12-13</th><th>13-14</th><th>14-15</th><th>15-16</th><th>16-17</th>
  <th>TT</th><th>SĐC</th>
</tr>
</thead>

<tbody>
<script>
const TO = [1,3,5,7,9];
TO.forEach(t=>{
document.write(`
<tr>
<td>${t}</td>
<td><input></td>
<td><input></td>
<td><input class="dm-ngay"></td>
<td><input class="dm-gio"></td>
<td><input class="usd-qt"></td>
${'<td><input class="gio"></td>'.repeat(9)}
<td class="tong-sp">0</td>
<td class="usd-th">0</td>
<td class="hs">0%</td>
<td><input></td>
<td><input></td>
<td><input></td>
<td><input></td>
<td class="usd100">0</td>
<td></td>
</tr>
`);
});
</script>
</tbody>

<tfoot>
<tr>
  <td colspan="6">CỘNG USD</td>
  ${'<td class="tong-usd-gio">0</td>'.repeat(9)}
  <td colspan="9"></td>
</tr>

<tr>
  <td colspan="6">ƯỚC TÍNH USD TRONG NGÀY</td>
  ${'<td class="uoc-usd-gio">0</td>'.repeat(9)}
  <td colspan="9"></td>
</tr>

<tr class="total-strong">
  <td colspan="23">TỔNG USD CUỐI NGÀY</td>
  <td id="tong-usd-ngay">0</td>
</tr>
</tfoot>
</table>

<script>
function calc(){
  let tongNgay=0;
  document.querySelectorAll("tbody tr").forEach(r=>{
    const gio=[...r.querySelectorAll(".gio")].map(i=>+i.value||0);
    const usdqt=+r.querySelector(".usd-qt").value||0;
    const dmngay=+r.querySelector(".dm-ngay").value||0;

    const tongSP=gio.reduce((a,b)=>a+b,0);
    const usdth=tongSP*usdqt;
    const hs=dmngay? (tongSP/dmngay*100):0;

    r.querySelector(".tong-sp").innerText=tongSP;
    r.querySelector(".usd-th").innerText=usdth.toFixed(2);
    r.querySelector(".hs").innerText=hs.toFixed(1)+"%";
    r.querySelector(".usd100").innerText=(dmngay*usdqt).toFixed(2);

    tongNgay+=usdth;
  });
  document.getElementById("tong-usd-ngay").innerText=tongNgay.toFixed(2);
}
document.addEventListener("input",calc);
</script>

</body>
</html>
